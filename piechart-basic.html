<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="plotly-import.html">


<!--
`piechart-basic`
This is a basic component for plotly piecharts

@demo demo/piechart_basic_demo.html
-->
<dom-module id="piechart-basic">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <div style="display:none;">{{dataset}}</div>
    <div id="diagram"></div>
  </template>

  <script>
    Polymer({
      is: 'piechart-basic',

      properties: {
        /** Datavalues to be plotted */
        dataset: {
          type: Array,
        },
        /** Labels for the dataset (must be same size as dataset)*/
        labels: {
          type: Array,
        },
        /** Colors for the dataset (must be same size as dataset)*/
        colors: {
          type: Array,
        },
      },
      /**
      * Transforms the transmitted data into a plot
      *
      * @param {Array<number>} dataset The data to be plotted
      * @param {Array<string>} labels The labels corresponding to the dataset
      * @param {Array<string>} colors The colors the data shall be displayed in
      */
      _plotDiagram: function (dataset, labels, colors) {
        var diagram = this.$.diagram;
        var data = [{
          values: dataset,
          labels: labels,
          type: 'pie',
          marker: {
            colors: colors
          },
        }];
        var layout = {
          height: 400,
          width: 500 //TODO check how to do better
        };
        Plotly.newPlot(diagram, data, layout);
      },
      ready: function() {
        if(this.dataset && this.labels) {
          this._plotDiagram(this.dataset, this.labels, this.colors);
        }
        else {
          console.log("[ERROR] You did not supply any data.");
        }
      }
    });
  </script>
</dom-module>
