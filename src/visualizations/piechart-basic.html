<link rel="import" href="../../../polymer/polymer-element.html">
<link rel="import" href="../../../polymer/lib/elements/dom-module.html">
<link rel="import" href="../mixins/plotly-mixin.html">
<link rel="import" href="../shared-styles/plotly-styles.html">

<dom-module id="piechart-basic">
    <template>
        <style include="plotly-styles">
            :host {
                display: block;
            }
        </style>
        <div id="diagram"></div>
    </template>

    <script>
        /**
         * ## `piechart-basic`
         *
         * This is a basic component for plotly piecharts.
         *
         * For further information and deeper understanding visit the [Plotly pie chart documentation](https://plot.ly/javascript/pie-charts/).
         *
         * @polymer
         * @customElement
         * @demo demo/visualizations/piechart_basic_demo.html
         */
        class PiechartBasic extends PlotlyMixin(Polymer.Element) {

            static get is() {
                return 'piechart-basic';
            }

            static get properties() {
                return {
                    /** Colors for the dataset (must be same size as dataset)*/
                    colors: Array,
                    /** Determines whether the legend should be hidden */
                    hideLegend: Boolean
                };
            }

            static get observers() {
                return [];
            }

            /** Gets the container element of the diagram that should be rendered */
            getDiagram() {
                return this.$.diagram;
            }

            /** Gets the data of the plot */
            getPlotData(data) {
                if (Array.isArray(data)) {
                    data = data[0];
                }

                return [{
                    type: 'pie',
                    values: data.values,
                    labels: data.labels,
                    showlegend: !this.hideLegend,
                    marker: {
                        colors: this.colors
                    }
                }];
            }

            /** Gets the layout options of the plot */
            getLayout() {
                return {
                    margin: {l: 0, r: 0, t: 0, b: 0}
                };
            }
        }

        // Register custom element definition using standard platform API
        customElements.define(PiechartBasic.is, PiechartBasic);
    </script>
</dom-module>
